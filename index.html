<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StreamWave Player</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Configure Tailwind for a dark theme and custom font -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary-dark': '#121212',
                        'secondary-dark': '#181818',
                        'card-dark': '#282828',
                        'accent-green': '#1DB954',
                        'text-light': '#ffffff',
                        'text-muted': '#b3b3b3',
                        'alert-red': '#ef4444'
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <style>
        /* Custom scrollbar for the playlist */
        .playlist-scroll::-webkit-scrollbar {
            width: 8px;
        }
        .playlist-scroll::-webkit-scrollbar-thumb {
            background-color: #535353;
            border-radius: 4px;
        }
        .playlist-scroll::-webkit-scrollbar-track {
            background-color: transparent;
        }
        /* Hide default audio element controls */
        audio {
            display: none;
        }
        /* Custom styling for the range input (progress bar) */
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 12px;
            width: 12px;
            background: #ffffff;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.3);
            margin-top: -5px; /* Adjust to center vertically */
        }
        input[type=range]:hover::-webkit-slider-thumb {
            background: #1DB954;
        }
    </style>
</head>
<body class="bg-primary-dark text-text-light font-sans h-screen flex flex-col overflow-hidden">

    <!-- Audio Element (hidden) -->
    <audio id="audio-player"></audio>

    <!-- Main Application Container -->
    <div class="flex flex-grow overflow-hidden">
        
        <!-- Sidebar Navigation -->
        <div id="sidebar" class="w-64 bg-black p-4 flex-shrink-0 hidden md:block overflow-y-auto">
            <div class="space-y-4">
                
                <!-- Player Status Section (Static) -->
                <div id="auth-section" class="mb-6">
                    <div class="text-3xl font-bold text-accent-green mb-4">StreamWave</div>
                    <!-- This now shows the static player status -->
                    <p class="text-text-muted text-sm font-semibold">Player Initialized</p>
                </div>
                
                <!-- Navigation -->
                <nav class="space-y-2">
                    <a href="#" id="home-nav" class="flex items-center space-x-3 p-2 rounded-lg bg-card-dark transition duration-150 font-semibold text-text-light">
                        <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-2-14v10l8-5-8-5z"/></svg>
                        <span>All Songs</span>
                    </a>
                </nav>

                <div class="h-px bg-secondary-dark my-4"></div>

                <!-- Simple Information Block -->
                <div class="p-2 text-text-muted text-xs bg-card-dark rounded-lg">
                    <p class="font-bold text-accent-green mb-1">Song List Managed in Code</p>
                    <p>Edit the **`defaultSongs`** array in the script section to change the tracks.</p>
                </div>
            </div>
        </div>

        <!-- Main Content Area -->
        <div class="flex-grow p-4 md:p-6 bg-secondary-dark rounded-lg m-2 md:m-4 overflow-y-auto playlist-scroll">
            <header class="mb-8 flex justify-between items-center">
                <div>
                    <h1 id="main-header-title" class="text-4xl md:text-5xl font-extrabold mb-2">StreamWave Library</h1>
                    <p id="main-header-subtitle" class="text-text-muted">Master list of all available tracks (Cloudinary Link Loaded).</p>
                </div>
            </header>

            <!-- Song List -->
            <div class="bg-card-dark rounded-xl p-4 shadow-2xl">
                <div class="grid grid-cols-[30px_1fr_150px_80px] text-text-muted text-xs uppercase tracking-wider border-b border-text-muted/20 pb-2 mb-3 px-2">
                    <span>#</span>
                    <span>Title</span>
                    <span class="hidden md:block">Album / Source</span>
                    <span>Duration</span>
                </div>
                <div id="playlist-container" class="space-y-1">
                    <!-- Song Items will be injected here by JavaScript -->
                </div>
            </div>
            
            <!-- Extra spacer to prevent content from being hidden by the fixed footer -->
            <div class="h-32 md:h-20"></div> 
        </div>

    </div>

    <!-- Fixed Footer Player Bar -->
    <footer class="bg-card-dark border-t border-secondary-dark h-24 flex items-center justify-between px-4 md:px-8 flex-shrink-0">
        <!-- 1. Current Song Info (Left) -->
        <div class="flex items-center space-x-3 w-1/3 min-w-0">
            <img id="player-cover" src="https://placehold.co/60x60/121212/ffffff?text=SW" alt="Album Cover" class="w-12 h-12 rounded-lg shadow-lg">
            <div class="min-w-0">
                <p id="player-title" class="text-sm font-semibold truncate">Select a Song</p>
                <p id="player-artist" class="text-xs text-text-muted truncate">StreamWave</p>
            </div>
        </div>

        <!-- 2. Controls & Progress (Center) -->
        <div class="flex flex-col items-center justify-center w-full md:w-1/3 px-4">
            <!-- Controls (Top Row) -->
            <div class="flex space-x-4 mb-1">
                <button id="prev-btn" class="text-text-muted hover:text-text-light transition disabled:opacity-50" title="Previous">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M6 6h2v12H6zm3.5 6l8.5 6V6l-8.5 6z"/></svg>
                </button>
                <button id="play-pause-btn" class="bg-text-light text-card-dark p-2 rounded-full hover:scale-105 transition shadow-lg">
                    <!-- Play Icon -->
                    <svg id="play-icon" class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
                    <!-- Pause Icon (hidden initially) -->
                    <svg id="pause-icon" class="w-5 h-5 hidden" fill="currentColor" viewBox="0 0 24 24"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg>
                </button>
                <button id="next-btn" class="text-text-muted hover:text-text-light transition disabled:opacity-50" title="Next">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M6 18l8.5-6L6 6v12zm9-12v12h2V6h-2z"/></svg>
                </button>
            </div>

            <!-- Progress Bar (Bottom Row) -->
            <div class="flex items-center space-x-2 w-full max-w-md">
                <span id="current-time" class="text-xs text-text-muted w-10 text-center">0:00</span>
                <input type="range" id="progress-bar" value="0" min="0" max="100" class="flex-grow h-1 appearance-none bg-text-muted/40 rounded-full cursor-pointer range-lg">
                <span id="duration" class="text-xs text-text-muted w-10 text-center">0:00</span>
            </div>
        </div>

        <!-- 3. Volume Control (Right) -->
        <div class="flex items-center space-x-2 justify-center w-1/3 hidden md:flex">
            <svg class="w-5 h-5 text-text-muted" fill="currentColor" viewBox="0 0 24 24"><path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.98 7-4.78 7-8.77s-2.99-7.79-7-8.77z"/></svg>
            <input type="range" id="volume-control" value="100" min="0" max="100" class="w-24 h-1 appearance-none bg-text-muted/40 rounded-full cursor-pointer">
        </div>
    </footer>


    <script type="module">
        // ----------------------------------------------------------------
        // V V V V V V V V V V V V V V V V V V V V V V V V V V V V V V V V V
        //  THIS IS WHERE YOU PASTE YOUR CUSTOM MP3 LINKS (Currently empty as the main song is in 'defaultSongs')
        // ----------------------------------------------------------------
        const CUSTOM_SONG_URLS_STRING = ``;
        // ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^
        // ----------------------------------------------------------------


        // --- Default Songs (Hardcoded) ---
        // This array now contains all four of your tracks!
        const defaultSongs = [
            {
                id: 'cloudinary-1',
                title: "Home 2019 Remaster",
                artist: "Twopical",
                album: "Twopicals Special",
                duration: "5:04",
                src: "https://res.cloudinary.com/dsrdtjv9u/video/upload/v1759872087/Home_-_2019_Remaster_pvx9bn.mp3", 
                // Cover image link
                cover: "https://yt3.googleusercontent.com/ComwB0EYdEw_DBgGQ4g_yFrUziQsqn2yI94h7_RYm2wae9h18kqPKoUU9jfWVFPjzvPWN3jJIg=s160-c-k-c0x00ffffff-no-rj"
            },
            {
                id: 'cloudinary-2',
                title: "King Of Nothing",
                artist: "Twopical",
                album: "Twopicals Special",
                duration: "3:13", 
                src: "https://res.cloudinary.com/dsrdtjv9u/video/upload/v1759872080/King_Of_Nothing_lhnu8e.mp3", 
                // Cover image link (same as above)
                cover: "https://yt3.googleusercontent.com/ComwB0EYdEw_DBgGQ4g_yFrUziQsqn2yI94h7_RYm2wae9h18kqPKoUU9jfWVFPjzvPWN3jJIg=s160-c-k-c0x00ffffff-no-rj"
            },
            {
                id: 'cloudinary-3',
                title: "Viva La Vida",
                artist: "Twopical",
                album: "Twopicals Special",
                duration: "3:18", 
                src: "https://res.cloudinary.com/dsrdtjv9u/video/upload/v1759871895/Viva_La_Vida_Sped_Up_vo5imz.mp3", 
                // Cover image link (same as above)
                cover: "https://yt3.googleusercontent.com/ComwB0EYdEw_DBgGQ4g_yFrUziQsqn2yI94h7_RYm2wae9h18kqPKoUU9jfWVFPjzvPWN3jJIg=s160-c-k-c0x00ffffff-no-rj"
            },
            {
                id: 'cloudinary-4',
                title: "I Ain't Worried",
                artist: "Twopical",
                album: "Twopicals Special",
                duration: "2:28", // New duration
                src: "https://res.cloudinary.com/dsrdtjv9u/video/upload/v1759871895/I_Ain_t_Worried_yaqrrd.mp3", // New MP3 link
                // Cover image link (same as above)
                cover: "https://yt3.googleusercontent.com/ComwB0EYdEw_DBgGQ4g_yFrUziQsqn2yI94h7_RYm2wae9h18kqPKoUU9jfWVFPjzvPWN3jJIg=s160-c-k-c0x00ffffff-no-rj"
            }
        ];
        
        // --- Song List State ---
        let customSongs = []; 
        let allSongs = []; 
        let currentSongIndex = -1;
        let isPlaying = false;


        // --- DOM Elements ---
        const audio = document.getElementById('audio-player');
        const playlistContainer = document.getElementById('playlist-container');
        const playPauseBtn = document.getElementById('play-pause-btn');
        const playIcon = document.getElementById('play-icon');
        const pauseIcon = document.getElementById('pause-icon');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const progressBar = document.getElementById('progress-bar');
        const volumeControl = document.getElementById('volume-control');
        const currentTimeEl = document.getElementById('current-time');
        const durationEl = document.getElementById('duration');
        const playerTitle = document.getElementById('player-title');
        const playerArtist = document.getElementById('player-artist');
        const playerCover = document.getElementById('player-cover');
        const homeNav = document.getElementById('home-nav');
        const authSection = document.getElementById('auth-section');


        // --- Utility Functions ---
        
        /**
         * Parses the raw URL string into structured song objects.
         */
        function parseCustomUrls(urlStr) {
            const urls = urlStr.split(/[\s,]+/).map(url => url.trim()).filter(url => url.startsWith('http'));
            
            return urls.map((url, index) => ({
                id: `custom-${index + 1}`,
                title: `Custom Track ${index + 1}`,
                artist: `User Upload`,
                album: `Custom Links`,
                duration: "??",
                src: url,
                cover: "https://placehold.co/60x60/535353/ffffff?text=UPL"
            }));
        }

        /**
         * Returns the combined master list of hardcoded and custom-added songs.
         */
        function getFullSongLibrary() {
            customSongs = parseCustomUrls(CUSTOM_SONG_URLS_STRING);
            return [...defaultSongs, ...customSongs];
        }

        /**
         * Formats seconds into MM:SS string.
         */
        function formatTime(seconds) {
            const minutes = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${minutes}:${secs < 10 ? '0' : ''}${secs}`;
        }
        
        
        // --- Core Player Functions ---
        
        function loadSong(index) {
            if (index < 0 || index >= allSongs.length) return;
            currentSongIndex = index;
            const song = allSongs[currentSongIndex];
            
            if (!song || !song.src) {
                console.error("Attempted to load invalid song:", song);
                return;
            }

            audio.src = song.src;
            playerTitle.textContent = song.title;
            playerArtist.textContent = song.artist;
            playerCover.src = song.cover;
            durationEl.textContent = song.duration || "0:00"; 
            currentTimeEl.textContent = "0:00"; 
            progressBar.value = 0; // Reset progress bar

            document.querySelectorAll('.playlist-item').forEach(item => {
                item.classList.remove('bg-accent-green/20', 'text-text-light');
                item.classList.add('hover:bg-card-dark', 'text-text-muted');
            });
            const activeItem = document.getElementById(`song-${song.id}`);
            if (activeItem) {
                activeItem.classList.add('bg-accent-green/20', 'text-text-light');
                activeItem.classList.remove('hover:bg-card-dark', 'text-text-muted');
            }
        }

        function togglePlayPause() {
            if (currentSongIndex === -1) {
                if (allSongs.length > 0) {
                    loadSong(0);
                    playSong();
                }
                return;
            }

            if (isPlaying) {
                pauseSong();
            } else {
                playSong();
            }
        }

        function playSong() {
            if (currentSongIndex === -1) return;
            audio.play().catch(error => {
                console.error("Playback failed (browser auto-play policy or bad link):", error);
            });
            isPlaying = true;
            playIcon.classList.add('hidden');
            pauseIcon.classList.remove('hidden');
        }

        /**
         * Explicit function to handle pausing, ensuring isPlaying state is updated.
         */
        function pauseSong() {
            audio.pause();
            isPlaying = false;
            pauseIcon.classList.add('hidden');
            playIcon.classList.remove('hidden');
        }

        function playNext() {
            if (allSongs.length === 0) return;
            let nextIndex = (currentSongIndex + 1) % allSongs.length;
            loadSong(nextIndex);
            playSong(); // Automatically play the next song
        }

        function playPrev() {
            if (allSongs.length === 0) return;
            let prevIndex = (currentSongIndex - 1 + allSongs.length) % allSongs.length;
            loadSong(prevIndex);
            playSong(); // Automatically play the previous song
        }

        // --- UI Rendering ---

        function renderSongList(songsToRender) {
            playlistContainer.innerHTML = ''; 
            
            if (songsToRender.length === 0) {
                playlistContainer.innerHTML = '<p class="text-text-muted p-4 text-center">No songs in the library. Add tracks to the **defaultSongs** array in the code!</p>';
                return;
            }

            songsToRender.forEach((song, index) => {
                const item = document.createElement('div');
                item.id = `song-${song.id}`;
                item.className = 'playlist-item grid grid-cols-[30px_1fr_150px_80px] p-2 rounded-lg text-text-muted text-sm hover:bg-card-dark transition duration-150 cursor-pointer items-center';
                item.setAttribute('data-id', song.id);
                
                item.addEventListener('click', () => {
                    const songIndex = allSongs.findIndex(s => s.id === song.id);
                    if (songIndex === currentSongIndex) {
                        togglePlayPause();
                    } else {
                        loadSong(songIndex);
                        playSong();
                    }
                });

                item.innerHTML = `
                    <span class="text-center">${index + 1}</span>
                    <div class="flex flex-col">
                        <span class="text-text-light font-medium truncate">${song.title}</span>
                        <span class="text-xs truncate">${song.artist}</span>
                    </div>
                    <span class="hidden md:block truncate">${song.album || 'Unknown'}</span>
                    <span>${song.duration || '0:00'}</span>
                `;
                playlistContainer.appendChild(item);
            });
        }
        
        /**
         * Initializes the player logic and UI unconditionally (no auth required).
         */
        function initPlayerLogic() {
            // Update the sidebar status
            authSection.innerHTML = `
                <div class="text-3xl font-bold text-accent-green mb-4">StreamWave</div>
                <p class="text-text-muted text-sm font-semibold">Player Initialized</p>
            `;

            allSongs = getFullSongLibrary();
            renderSongList(allSongs);
            
            if (allSongs.length > 0) {
                // Do not auto-play, just load the first song to show metadata
                loadSong(0); 
                pauseSong(); // Ensure player is in a paused state initially
            }
        }

        // --- Event Listeners ---

        playPauseBtn.addEventListener('click', togglePlayPause);
        nextBtn.addEventListener('click', playNext);
        prevBtn.addEventListener('click', playPrev);

        volumeControl.addEventListener('input', (e) => {
            audio.volume = e.target.value / 100;
        });
        audio.volume = volumeControl.value / 100;

        audio.addEventListener('timeupdate', () => {
            currentTimeEl.textContent = formatTime(audio.currentTime);
            const progress = (audio.currentTime / audio.duration) * 100;
            progressBar.value = isNaN(progress) ? 0 : progress;
        });

        audio.addEventListener('loadedmetadata', () => {
            const totalDuration = formatTime(audio.duration);
            durationEl.textContent = totalDuration;
            progressBar.max = 100; 
            progressBar.value = 0;
        });

        progressBar.addEventListener('input', (e) => {
            const seekTime = (e.target.value / 100) * audio.duration;
            audio.currentTime = seekTime;
            currentTimeEl.textContent = formatTime(seekTime);
        });

        audio.addEventListener('ended', playNext);

        homeNav.addEventListener('click', (e) => {
            e.preventDefault();
            initPlayerLogic();
        });


        // 9. Initialize on DOM Load
        document.addEventListener('DOMContentLoaded', () => {
            initPlayerLogic();
        });

    </script>
</body>
</html>
